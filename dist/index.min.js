"use strict";var express=require("express"),path=require("path"),fs=require("fs"),sharp=require("sharp"),app=express(),PORT=8080;app.set("view engine","ejs"),app.set("views",path.join(__dirname,"views")),console.log("Folder index.js:",__dirname),console.log("Folder curent (de lucru):",process.cwd()),console.log("Cale fișier:",__filename);for(var obGlobal={obErori:null},vectorFoldere=["temp","poze_uploadate","backup","temp1"],_i=0,_vectorFoldere=vectorFoldere;_i<_vectorFoldere.length;_i++){var folder=_vectorFoldere[_i],folderCaleAbsoluta=path.join(__dirname,folder);fs.existsSync(folderCaleAbsoluta)||fs.mkdirSync(folderCaleAbsoluta)}function initErori(){try{var e=fs.readFileSync(path.join(__dirname,"resurse/json/erori.json"),"utf-8");obGlobal.obErori=JSON.parse(e),obGlobal.obErori.eroare_default.imagine="/resurse/imagini/erori/"+obGlobal.obErori.eroare_default.imagine;var r=!0,i=!1,a=void 0;try{for(var o,n=obGlobal.obErori.info_erori[Symbol.iterator]();!(r=(o=n.next()).done);r=!0){var t=o.value;t.imagine="/resurse/imagini/erori/"+t.imagine}}catch(e){i=!0,a=e}finally{try{r||null==n.return||n.return()}finally{if(i)throw a}}}catch(e){console.error("Eroare la citirea fișierului erori.json:",e)}}function afisareEroare(e,r,i,a,o){var n=obGlobal.obErori.info_erori.find(function(e){return e.identificator===r})||obGlobal.obErori.eroare_default,t=path.join(__dirname,"resurse/imagini/erori",n.imagine.split("/").pop());fs.existsSync(t)||(n.imagine="/resurse/imagini/erori/interzis.png"),e.status(n.status?r:400).render("pagini/eroare",{titlu:i||n.titlu,text:a||n.text,imagine:n.imagine})}app.use("/resurse",express.static(path.join(__dirname,"resurse"))),app.get("/favicon.ico",function(e,r){r.sendFile(path.join(__dirname,"resurse/imagini/ico/favicon.ico"))}),app.get(["/","/index","/home"],function(e,r){r.render("pagini/index",{ip:e.ip})}),app.get(/^\/resurse\/[a-z0-9A-Z/_-]+$/i,function(e,r){afisareEroare(r,403)}),app.get("/*.ejs",function(e,r){afisareEroare(r,400)}),app.get("/*",function(e,i){var r=e.url,a=path.join(__dirname,"views","pagini",r+".ejs");if(!fs.existsSync(a))return afisareEroare(i,404,"Pagina negăsită","Verificați calea URL-ului");i.render("pagini"+r,function(e,r){if(e)return afisareEroare(i,404,"Pagina negăsită","Verificați calea URL-ului");i.send(r)})}),initErori(),app.listen(PORT,function(){console.log("Serverul rulează la http://localhost:".concat(PORT))});
//# sourceMappingURL=index.min.js.map
